---
- name: Check if caddy is already installed
  stat:
    path: /etc/caddy/.installed
  register: caddy_install

- name: Install
  when: not caddy_install.stat.exists
  block:
  - name: Install Caddy
    include_role:
      name: maxhoesel.caddy.caddy_server

  - name: Create installed flag file
    file:
      path: /etc/caddy/.installed
      state: touch
      mode: 0644
